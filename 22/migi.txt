x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x

--- 第5章: えちぃげーむのCD・DVDチェックの外し方 ---

著者：右サイド

x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x


■0x01.) はじめに

　皆さんはえちぃげーむをやったことがあるでしょうか？
　やったことがある人なら一度はお目にかかるCDチェックドライブの容量に余裕
があるなら仮想ドライブに突っ込んでおけば問題ありません。しかし、やっぱり
容量は無駄遣いしたくないし、ドライブも痛めたくありません。そんなわけで、
今回はCD・DVDチェックを外してしまいましょう！！


■0x02.) 準備

・Ollydbg（これがなきゃ始まらない）
・魔界天使ジブリール（製品版___体験版では無理）
http://frontwing.jp/

　え〜、このジブリールよいです。陵辱系の部類に入ると思いますがそこまでき
つくありません。ギャグ要素も満載で、初心者にもすんなり受け入れられると思
います。ロリっ子もいますし…ﾌﾌﾌ。おすすめの一品です（読者の皆様すいません。
右が馬鹿なせいで、エロゲーの紹介まで……）。


■0x03.) 解析開始

　それでは、まずはじめにOPでも見てみましょう。
　ムービーの質としてはジブリール2の方が格段に上なのですが…。あのRainbow
-Motion-Graphicsが作っているんですからあまり前といってはあれなのです。

　ではとりあえず、DVDを入れない状態で起動してみましょう。

警告：「DVD-ROMが見つかりません。製品のDVD-ROMを挿入して、再試行して下さ
い」

というメッセージのが出てくるはずです。

　この警告が重大なヒントになります。
　このダイアログを見つけ出して、そこにBP（ブレイクポイント）をセットしま
す。見事そこに当たったら、その前の処理の分岐を確認すればよいだけです。っ
てか、これを書いた時点で解析はもう終わりと見てよろしいのですが、エロゲー
ができない中学生・高校生の諸君のために先人の残した資料と言うことで書きま
す（まあ、今時中学生でもエロゲー買ってますから、祖父地図でも行って買って
きてください。店員さんが恐ろしいという人は、通販でどうぞ〜）。

　とりあえず、Ollyに突っ込んで参照文字列の検索をしてください。
　0042CEBBに警告に出てきた文字列が見えますので、そこにBPを仕掛けてくださ
い。

-----
0042CEA5  |. FF15 DC554600  CALL DWORD PTR DS:[<&ole32.CoInitialize>>;  ole32.CoInitialize
0042CEAB  |. E8 3CACFFFF    CALL ADV.00427AEC
0042CEB0  |. 0FB6C0         MOVZX EAX,AL
0042CEB3  |. 85C0           TEST EAX,EAX
0042CEB5  |. 75 23          JNZ SHORT ADV.0042CEDA
0042CEB7  |> 6A 00          /PUSH 0                                  ; /Arg3 = 00000000
0042CEB9  |. 6A 35          |PUSH 35                                 ; |Arg2 = 00000035
0042CEBB  |. 68 00C34900    |PUSH ADV.0049C300                       ; |Arg1 = 0049C300
0042CEC0  |. E8 2BD80200    |CALL ADV.0045A6F0                       ; \ADV.0045A6F0
0042CEC5  |. 83F8 02        |CMP EAX,2
0042CEC8  |. 0F84 AF000000  |JE ADV.0042CF7D
0042CECE  |. E8 19ACFFFF    |CALL ADV.00427AEC
0042CED3  |. 0FB6C0         |MOVZX EAX,AL
0042CED6  |. 85C0           |TEST EAX,EAX
0042CED8  |.^74 DD          \JE SHORT ADV.0042CEB7
-----

　こんな場所に出てきます。
　すまん............先にいわしてくれ。さっきの場所の1カ所を書き換えたら、
もう講座が終了してしまいます。ソフト選択間違えた！！あはははは……orz

　ちなみに書き換える場所は次のところです。

-----
0042CEB5  |. 75 23          JNZ SHORT ADV.0042CEDA
-----

　このJNZをJMPに変えれば素敵に起動します。これを応用すれば、他のソフトの
解析の場面でも役に立ちます。たま〜に、デバッガの検出をするソフトが存在す
るので、そのときは自分で対処してください。Canvaas2なんかがそうです。もう
これで、P2Pでのクラックパッチ探しに困る必要が無く自給自足なエロゲライフが
送れますね♪
　もうちょっと歯ごたえのある解析がしたかったのですが、偶然あったチェック
のあるソフトがこれしかなかったので、こんな短く簡単な解析になってしまいま
した。時間と根気と技術があればどのファイルをチェックしているのかまで求め
たかったのですが、技術と根気がないので、きれいさっぱり諦めました。

　それではまた〜。


