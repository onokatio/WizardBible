x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x

--- 第○章: 基礎暗号学講座・第14回 〜仮定の重要性〜 ---

著者：IPUSIRON

x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x


■0x01.) はじめに

　前回のWB39ではハッシュ関数について取り上げた。まず圧縮関数からハッシュ
関数が構成できることを確認した。次に、衝突困難問題と弱衝突困難問題と呼ば
れる2つの問題を定義し、どちらの問題が解くのに困難であるかということを直観
的に確認した。その後、衝突困難（あるいは弱衝突困難）な圧縮関数が存在すれ
ば、衝突困難（あるいは弱衝突困難）なハッシュ関数を構成できることを示した。
つまり、部品となる圧縮関数の安全性を維持したまま、ハッシュ関数を構成でき
るのであった。

　さらに、WB33ではElGamal暗号という公開鍵暗号を紹介した。このElGamal暗号
を破ることと、DH問題（後ほど言及するが厳密にはCDH問題）を解くことが同程度
に困難であることを示した。つまり、ElGamal暗号の安全性はDH問題の困難さと等
価であるのだ。言い換えれば、少なくともDH問題を解くことが困難であることを
仮定しなければ、ElGamal暗号は安全ではないことを意味する。ここで安全と一言
で言ってしまっているが、きちんと書くと次のようになる。ElGamal暗号はCDH仮
定の下で、選択平文攻撃に対して完全解読できない（OW-CPA安全）。これはすで
にWBにおいて証明済みである。
　また、ElGamal暗号の安全性を高めるために、鍵生成アルゴリズムに改良を施し
た方式（素数位数を持つ群を用いる）として拡張ElGamal暗号が存在する。この拡
張ElGamal暗号はDDH仮定の下で、選択平文攻撃に対して部分解読さえもできない
こと（IND-CPA安全）が知られている。

　そして、WB34では（教科書的）RSA暗号と呼ばれる公開鍵暗号を紹介した。この
RSA暗号はRSA仮定の下で、OW-CPA安全（受動的攻撃に対して一方向性の安全性ま
で）であることが知られている。

　以上のように、暗号技術のサービス（暗号化・署名・ハッシュ・認証など）を
安全に実現するためには、何らかの仮定が必要とされる。さらに、その仮定が変
われば、満たされる安全性も変わってくる。よって、暗号技術の安全性を語ると
きは仮定を明確にしなければならない。

　そこで今回の記事では「仮定」に焦点を当てていく。まず、代表的な仮定であ
る離散対数仮定を復習し、その仲間であるCDH仮定とDDH仮定を紹介する。そして、
それらの仮定の間の関係を直観的に確認していく。


■0x03.) DL問題とDL仮定

　DL問題（離散対数問題）と離散対数仮定は最も基本的なもののひとつなので、
復習として再掲する。ただし、ここで述べる定義は完全に厳密なものではないこ
とに注意して欲しい。

　Gを素数位数pの巡回群、gをGの生成元、hをGの元とする。このとき、(G,p,g,h)
が与えられたときに、g^x≡h (mod p)を満たす正の整数xを求める問題をDL問題と
呼ぶ。

　そして、DLPを解く効率的なアルゴリズムが存在しないという仮定のことを、
（群Gに対する）DL仮定と呼ぶ。

　ものすごくラフに言えば、gの右肩であるxを解く問題がDL問題であり、その問
題を効率的に解けないという仮定がDL仮定ということである。


■0x04.) CDH問題とCDH仮定

　Gを素数位数pの巡回群、gをGの原始元、x,yをランダム値とする。このとき、(G
,p,g,g^x mod p,g^y mod p)が与えられたときに、g^xy mod pを求める問題をCDH
（Computational Diffie-Hellman）問題という。

　そして、CDH問題を解く効率的なアルゴリズムが存在しないという仮定のことを、
CDH仮定と呼ぶ。

　このCDH問題・CDH仮定の概念は、WB33でDH問題・DH仮定と呼んでいたものと同
じである。つまり、実はWB33では厳密性を捨ててCDHのことをDHと呼んでいたので
ある。


■0x05.) DDH問題とDDH仮定

　CDH問題に似た問題としてDDH問題と呼ばれる問題を考えることができる。

　Gを素数位数pの巡回群、gをGの生成元、x,yをランダム値とする。このとき、(G
,p,g,g^x mod p,g^y mod p)が与えられたときに、g^xy mod pの部分情報を求める
問題をDDH（Computational Diffie-Hellman）問題という。

　先ほどのCDH問題ではg^xy mod pの値を完全に求めることであった。一方、DDH
問題では、g^xy mod pの値の部分情報、つまり1ビットさえ求めればよいことを意
味する。よって、明らかにCDH問題よりもDDH問題の方が解くことが容易な問題を
意味していることがわかる。

　このDDH問題は識別不可能という表現を使って、言い換えると次のようになる。
　Gを素数位数pの巡回群、gをGの原始元、x,y,zをランダム値とする。このとき、
(G,p,g,g^x mod p,g^y mod p,g^xy mod p)と(G,p,g,g^x mod p,g^y mod p,g^z 
mod p)を識別する問題のことをDDH問題という。

　一般的に後者の定義の方が表現しやすいので使われている。しかし、慣れるま
では意味的は全射の方がわかりやすいのではないだろうか。

　そして、DDH問題を解く効率的なアルゴリズムが存在しないという仮定のことを、
DDH仮定と呼ぶ。


■0x06.) CDH問題 vs DDH問題

　CDH仮定とDDH仮定を定義できた。そこでこの2つの仮定の強弱を確認してみる。
仮定の強弱を考えるときは、まず問題の困難性の差を考えるとわかりやすい。こ
こでも問題の困難性から見ていく。

　CDH問題とDDH問題を比較すると、DDH問題の方が解くのが容易である。なぜなら
ば値を完全に求めるよりも、部分的に求める方が直観的に楽だからである。実際
に、CDH問題を解くことができれば、DDH問題を解いていることにもなる。定義の
意味から、値（g^xy mod p）を完全に求めていれば、部分的にも自動的に解いて
いることを意味するからである。言い換えれば、CDH問題を解くアルゴリズムが存
在すれば、DDH問題を解くアルゴリズムを作ることができることを意味している。

　実際のCDH問題を解くアルゴリズムを利用して、DDH問題を解くアルゴリズムの
構成は次のようになる。まず、DDH問題を解くアルゴリズムの入力として(g,g^x,
g^y,Z=g^xy or g^z)が与えられる（G,pなどは略した）。DDH問題を解くアルゴリ
ズムは内部でCDH問題を解くアルゴリズムを用いて、g^x,g^yからg^xyを計算する。
後はg^xy=Zが成り立つかどうかを検証する。成り立てば入力は(g,g^x,g^y,Z=g^xy)
と判断でき、成り立たなければ(g,g^x,g^y,Z=g^z)と判断できる。

　一方、DDH問題が解けたからといって、CDH問題が解けるとは限らない。ここで
注意して欲しいのは「解けない」とは言っていないことである。値を部分的に解
いて、その後に何らかのうまい方法を使って、値全体を解いてしまうかもしれな
いのである。しかし今のところはそのうまい方法も見つかっていないし、うまい
方法がまったくないということも証明されていない。もしうまい方法が見つかっ
たら、CDH問題とDDH問題は同じ困難さを持つことになる。また、もしうまい方法
が存在しないことが証明されたら、CDH問題はDDH問題より真に困難であることに
なる。

　以上のことをまとめると、CDH問題が解ければDDH問題は解けるということまで
がわかっていることになる。困難さを大小関係で表せば、次のように表現できる。
ただし、「＞」という記号には「≧」の可能性も秘めていると解釈してもらいた
い。

CDH問題＞DDH問題

　これで問題の（困難さの意味での）強弱関係はわかった。


■0x07.) CDH仮定 vs DDH仮定

　次にCDH仮定とDDH仮定の強弱について説明する。CDH問題はDDH問題より困難な
問題であることは直観的に確認した。もう少し厳密に見たければ、アルゴリズム
が構成できることを確認すればよい。これは簡単なので各自の宿題にしておこう。

　そもそも「問題が困難」というのは誰が対象かというと、敵に対してである。
よって、敵にとって、CDH問題よりDDH問題の方が解きやすいことを意味する。つ
まり、敵にとってCDH問題を解くよりDDH問題を解く方が、仕事としてはやること
が少ないのである。

　ところで、問題を解くアルゴリズムが存在しないこと、即ち問題を困難である
ことを、仮定とした。例えば、CDH問題を解くことは敵にとってやりにくい仕事で
あり、それを仮定するということは敵にとって「やりにくいことができない」と
前提としている。また、DDH問題を解くことは敵にとってやりやすい仕事であり、
これを仮定するということは敵にとって「やりやすいことができない」と前提し
ている。比較すると、DDH仮定の方が敵にとってやりやすいことができないとして
いるため、前提とすることが大きい。つまり、仮定が強いといえる。以上をまと
めると、次のような仮定の強弱関係になる。

CDH仮定＜DDH仮定

　暗号を設計するときはなるべく弱い仮定を前提とした方がよい。仮定と問題の
強弱関係はクロスしていて慣れないと混乱するかもしれない。そこで、私の場合
は慣れるまで、次のような手順で思考するようにしていた。

・暗号を作るときは仮定がそもそも存在しない方が嬉しい。
・しかし仮定なしに作ることは多分無理だから、できれば弱い仮定で作りたい。

　このように考えると、仮定の「弱い」という意味と仮定なしの「量的にゼロ」
という意味に自然な関連ができていて想像しやすい。


■0x08.) DL仮定 vs CDH仮定

　DDH仮定はCDH仮定より強いことを確認した。それではもっとも基本的な仮定の
ひとつであるDL仮定と比較するとどうなるだろうかという疑問が浮かぶ。

　DL問題とはラフに言えば、累乗の部分であるgの右肩のxを完全に求める問題で
ある。仮に、DL問題を解けるアルゴリズムが存在したとする。すると、CDH問題の
インスタンスである(g,g^x,g^y)（G,pなどは略した）が与えられたときに、g^xか
らxを求められる。これはDL問題を解くことができるとしているから当たり前であ
る。また、同様にg^yからyも求められる。つまり、x,yを知ることができたので、
xyを計算できる。そして、gはインスタンスとして入力されているので、g^xy全体
も計算できる。このg^xyを入力(g,g^x,g^y)に対する出力とすれば、CDH問題を解
いていることになる。よって、DL問題を解とければ、CDH問題を解くことができる
のである。つまり、DL問題の方がCDH問題よりも困難である。これを強弱関係で表
せば、次のようになる。

DL問題＞CDH問題

　仮定と問題の関係より、仮定の強弱は次のようになる。

DL仮定＜CDH仮定

　すでに得られた「CDH問題＞DDH問題」「CDH仮定＜DDH仮定」の関係を組み合わ
せれば、次のようになる。

DL問題＞CDH問題＞DDH問題

DL仮定＜CDH仮定＜DDH仮定

　したがって、暗号を設計するときは、DL仮定に基づくようにした方がよりよい
ことを意味する。ただし、DDH仮定などが駄目という意味ではない（しかもDDH仮
定より強い仮定はもっとたくさんある）。DDH問題にしろ効率的に解くアルゴリズ
ムがまだ発見されていないし、おそらく発見されないだろうと思われている。
　おそらく発見されないであろうものを積極的に使っていくという立場を取る人
もいるだろう。なぜならば、一般的に強い仮定から作った方が高い安全性とよい
効率性を持たせることが容易だからである。また、数学的にエレガントにするた
めに仮定は弱いに限るという立場を取る人もいるだろう。そのため、暗号の世界
では同じ暗号化であっても、色々な種類が存在するのである。どの暗号がよいの
かというのは、暗号を利用する側（例えば実装する側）の選択に任せられる。安
全性を重視するのか、仮定を重視するのか、効率性を重視するのかは、実装者の
立場で決めればよいのである。まずその立場を明確にした上で選択に入らないと、
妥当な選択になることは難しいだろう。


■0x09.) 仮定の重要性

　仮定を明確にすることは暗号の世界だけでなく、数学やその他の学問の世界で
も重要だと考えられる。なぜならば、仮定が明確になってしまわなければ、定理
を主張している人とその定理を解釈する人の間で誤解が生じる可能性があるから
である。このような誤解は建設的ではない。よって、何かを主張する場合は仮定
や想定しているモデルなどを明確にすべきである。

　極端な話をすれば、敵は通信の外部にいると仮定する。さらに、敵はすべての
通信を盗聴さえもできないと仮定する。
　前者の仮定により、敵は盗聴できないので、攻撃対象の通信を知ることができ
ない。また、後者の仮定により、敵は通信の外部にいるので、なりすまし行為や
乗っ取り行為を行えない。よって、2つの仮定により、敵の攻撃と攻撃対象がまっ
たく独立になってしまう。敵にとって攻撃対象のものがないわけであり、攻撃の
成功云々以前の問題である。ゆえに、この2つの仮定があれば、どんなに脆弱なシ
ステムでも問題がないわけである。

　しかし、この2つの仮定はどちらも現実的ではない。
　まず1番目の仮定が妥当であるためには、現実社会において完全に盗聴不可能で
ある通信路を実現できなければならない。そのためには、監視付きの専用線が必
要である。これはコスト上も現実的ではないし、インターネット上ではこの仮定
とは相反する明らかである。
　また、現実的には通信の相手の思惑などわかるわけないので、相手が悪意を持
っているか否かに係わらず通信の仕様通りに実行しているならば、こちらも仕様
通りに実行しなければならない。つまり、2番目の仮定も現実社会とギャップがあ
り、妥当ではない。


　以上のように仮定には妥当性のあるものを設定しなければならない。そして、
仮定を明確にした上で、はじめて結論を主張できるのである。


■0x0A.) 最後に

　今回は暗号の世界で登場する基本的な仮定であるDL仮定・CDH仮定・DDH仮定を
紹介した。他にもたくさんの仮定が存在する。ざっと挙げるだけでもDLIN仮定、
BDDH仮定、Square BDDH仮定、Qubic BDDH仮定、KEA1、KEA3、素因数分解困難仮定、
RSA仮定、強RSA仮定、One-More RSA Inversion仮定、SD仮定などである。私の知
らない仮定もたくさんある。こうしたその他の仮定は、WBで今後少しずつ紹介し
ていくつもりである（自分の勉強のためにも）。

　また、今回は仮定の強弱や問題と仮定の関係を述べた。私自身慣れるまでたび
たび仮定の強弱関係で混乱した。そこで、仮定を一旦問題に置き換え、その問題
を敵が解きやすいかどうかを思考して、仮定の強弱関係を導き出していた（賢い
人はすぐに理解するんだろうけども…）。この思考方法は今回WBで紹介した方法
と同じであるので、もし参考になればと思い執筆した次第である。

　今回せっかく拡張ElGamal暗号の話が少し出たので、次回は拡張ElGamal暗号の
定義と安全性について解説する予定である。



