x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x

--- 第○章: 初めてのmaltegto ---

著者：黒林檎

x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x


■0x01.) はじめに

　今回はソーシャルエンジニアリングっていう分野。 
　ソーシャルエンジニアリングを手助けするツールの説明のが正しい？ 
　最近ソーシャルエンジニアリングって本（[著]クリストファー.ハドナジーさん、
[訳]成田光影さん）買ったんですよ。
　それで色々面白く読ませてもらったんですけどmaltegoが少し気になって使おう
と思ったんですがアホの俺には情報があまりにも少ない。とりあえずWEBで検索し
てもなかなかの過疎度…。 
　専門家が危険危険っていってるの出てきただけで特に何もなかったんです…（泣）。
　もういい俺が調べてWizard Bibleのネタにしてやんよってことでとりあえず頑
張りました。 
　間違った内容ないようにしてるんですが…間違ってたらすいません。
　海外では正規の使い方以外だとソーシャルエンジニアリングとクラッキングの
下調べなんかに使われるみたいです。

>>情報収集やフットプリンティングは、ハッキングの第一歩であるように…（以
下略）。


■0x02.) maltegoってなんでよ!! 

(1)maltegoは視覚的に関係を確認することができる、情報収集ツールです 

・ドメイン名 
・Whois情報 
・DNS名 
・IPアドレス 
・など 

(2)maltegoは、情報を列挙することができます。 

・人の名前に関連付けられた電子メールアドレス 
・人の名前に関連付けられているWebサイト 
・人の名前に関連付けられた電話番号 
・人の名前に関連付けられている社会集団 
・人の名前に関連付けられている企業や組織 

(3)maltegoはまた、次のことができます。 
・電子メールアドレスの簡単な検証を行う。 
・タグとタグがフレーズの場合は、ブログを検索。 
・ドメインからファイルやメタデータを抽出します。 

…


■0x03.) 初めての起動

　maltegoを使う方法は2つ。…3つあるけども。

・Windowsからの起動
・Linux(それかMac)からの起動

　BackTrackにはmaltegoが既に入っているので、自前の環境に入れるのがメンド
クサイ方はそちらをご使用ください。 
　筆者はWindows版を利用します。 

　BackTrackでmaltegoを使うならばroot@bt:maltegoで起動します。
　一応BT5r3の仮想環境で試しました。 
　Windowsで利用する場合は、以下のURLからダウンロードできます。

http://www.paterva.com/web6/products/download2.php 

　ついでに無償版と有料版があるらしいです。実行できる機能数や保存できる量
が変わってくるみたいです。 
　ついでに気に入った方は600ドルでライセンス購入すればいいらしいですよ。

　…インストール初めて起動したら英語びっしり…メールアドレスとパスワード
と画像の文字打てっていわれたから打ってたらエラー吐きやがる…。
　よく読んだらアカウント作れって言ってるやん、最近のハッキングツールはな
んでもアカウント作成する時代かよ。とか思いつつアカウント作成します。

https://www.paterva.com/web6/community/maltego/index.php 

　ここで作成、メールアドレスは正規のでお願いね、確認メールくるから。
　名前kuro rinngoでいけたから別になんでもいいっぽい。
　とりま送信、なんかまだアカウント作成画面じゃん。とか思ったらちっさくse
nd mail（だっけ？）とか書いてたからメール確認。
　リンクきてるしクリック。
　んで”Activate your account”って出たからアカウントできたみたい。
　んじゃさっそくmaltegoのログインに戻る。
　んだよ、アカウントがアクティベート出来てないとかふざけんじゃねぇ。って
思いつつメールで送られてきたリンクみたらアカウントの有効化があった。
　とりあえずアカウントがmaltegoコミュニティにログインして使用できます。
ってアラートでたら成功っぽい。 
　んじゃもう出来るだろ、三度目の正直…。
　ログインに成功してしまいました。


■0x04.) 初めてのmaltegto 

　先ほど苦難の末、ログインに成功しました。
　起動したらもう簡単ですね。

　まずモード選択、今回はcompany stalkerで行きます。
　ドメインの入力が求められました。
　ターゲットドメインを指定します。そのドメインを元に.pdfや.xmlや.docファ
イルがグラフィックに自動で集まってきます。
　後、maltegoはレイアウトアルゴリズムの4種類をサポートしています。鍵アイ
コンのとなりにあります。 みたとおり、表示を変えれる。グラフィカルな表示を
好まない場合はEntry Listに変えるとよいです。

　例えば、Start a　MachineでfootprintL3（Lever1から3まであるけど、3が無駄
に結果一番多いだけ）を試せば、ネットブロックやASナンバーなどなど色んな情
報も出てきた。 
　どちらかというとAS NmberはLevel1で出てきますが、ApachやPHPといったあれ
ばよいという情報がLevel3で出てきます。

AS Numberとは：http://e-words.jp/w/ASE795AAE58FB7.html

　後は、試してるときにチェック事項で了承求められたらチェック。

　company stalkerは.pdfなどを抽出することは先ほど触った。

/*
5月訂正
Company Stalkerが仕様変更によりメールアドレスの抽出に変わりました。
使い心地が悪くなってしまいました....(汗)
*/

　しかしmaltegoはドメインからの求める情報だけでなく、TwitterのIDから位置
情報が付加されていれば位置情報や過去につぶやいた内容など一連を抽出しだし
てくれる。

　Twitter関係をmaltegoで行う場合は…。Twitter [＊＊＊＊]です。

　お勧めはgeo location...先ほど述べた位置情報を抽出してくれる機能。俺が対
象に調べたアカウントでは東京新宿と出てきた。自分のアカウントにもスキャン
をあけた結果...何も出てこなかった。これは悪用とかじゃなく自分のアカウント
に対して位置情報を付加さしていないか調べるのに最適だと思った。 

　後はTwitter-Diggerで対象アカウントについて抽出。後は実名から実在し知り
えるアドレスを調べることが出来る機能がある。
 
　その場合Person-Email Address。
　これは名前を入力すればそれにあったメールアドレスを探してきてくれる優れ
もの..?
　ついでに俺は適当な名前でやったら三件ヒットしました。

…ざっと触った感じこんな感じ。


■0x05.) 実験して思った事 

　.pdfなど自動で集めれるのは良かった。
　特にそれをアップロードしたユーザー？がわかったりしたのか? 

[ドメイン]→[example.pdf]→[黒林檎]...みたいな。

　まぁソーシャルエンジニアリングとか不正アクセスの下調べとかに使われそう
なツールであることは実感出来た。 
　有償版ならさらに素晴らしい情報を手に入れれるのだろう。
　思った事といったら某所をスキャンした結果にやはりPDFをUPした？名前が存在
していた事。しかもこれアカウントでいうところのユーザー名じゃね？って奴。
しかもNONEになってないからまだ実在してんじゃね？って…。
　これはセキュリティ的にどうなの？って思うけどまぁOKなんでしょう。
　それと対となる所をしらべたけどどう考えても捨てアカウントみたいなユーザ
ーで作ってるわ、公開するならひとつのアカウントでまとめてるわ。と綺麗でし
た…（笑） 
　やっぱりこういう所で差が出ちゃうね…。

　…ここまで今年の3月頃の内容でして、v3.0の使用が変更されてPDF(ファイル)
アップロードした列挙機能に変わり、サイト内のメールアドレスを自動収集する
仕組みに変わってしまいました。
　個人的に改悪という形になり、あんな事やこんな妄想」が出来なくなってしま
いました。

　このアップロードで攻撃者的に便利な使い方を紹介するなら。
　サイト内のアドレス自動収集をして。ユーザー名@google.comという形が多いと
思います

/*わかり易いたとえとしてGoogleを使用しました。*/
だいたいユーザー名が大多数だと思うので、maltegoを使用すれば容易にその情報
を取得することが可能です。

…(でも本当この機能よりファイルアップロード列挙のほうがよかった…)

っていうことはログイン認証部分のユーザー名の推測の手間は省けるので残りは
パスワードだけということになりました。

意外にDNSフォレンジックツールといえど攻撃者的にも使用する甲斐がある道具で
あるといえます。

//悪用はしてはいけません。


■0x06.) 感想 

　今回はインターネットフォレンジックにあたるだろう分野について書いてみま
した。 
　実際meltegoではまだまだ触れてないことがあるはずだし、このツールはもっと
使いこなしてみたいツールですね。
　Creat a new graphで新規window作るとか、windowクリックしてモード選択画面
にとか事前説明してないけど、不必要だと思いましたの…。
　後はデータのSAVEとか正直UI巣晴らしくわかりやすいから感覚でわかっちゃい
ますよね…。
　maltegoを使用すればあんなことやこんなことが素早くできるので、是非Ollyd
bgみたいに使用しましょう。

/*
maltegoの記事(黒林檎作)をアメーバブログに公開しているので見てください。
＿Maltegoの仕様が変更された??＿
http://ameblo.jp/r00tapple/entry-11548772727.html
*/

　maltegoなんかは個人を調べる際に使う物ですがインターネットフォレンジック
はサーバーがどのような活動をしてるか調べる事も業務のうちです。
　とか色々笑えないこと言ってますが(矛盾という意味で)
　maltegoはDNSフォレンジックツールの分類です(笑)
　なので、「それちげぇよｗｗ」とか言われるかも知れませんが承知の上!!
　Start a　MachineでfootprintL3なんかがそういう昨日だと思うのですが、もう
Twitterみたりサイト内情報抽出してくれたり…と。
　色々使えるツールになっちゃってます(笑)
　ブログでもmaltegoは随時ネタとして使うつもりなので是非!!

■0x07.) 黒林檎のBlogから抜粋おまけ

　Maltegoには…。
　抽出した、メールアドレスを…。
　Google Me !をクリックし検索をかけると…。っていう検索結果を自動で出して
くれる優れた機能がついています(笑)

/*要するにメールアドレス抽出してそのままGoogle検索かけれるって事。*/

＿追記更新6月10日＿
申し訳ないです、Maltegoの仕様変更されましたが、機能自体は使えるもの選択さ
えすれば使用出来るので紹介します。

//これ重要で、デフォルトだとメールアドレスの抽出だけなんだけど、指定すれ
ば前みたいにデータ取れる。

このように右クリック操作で選択させる事で、->特に指定なければ"ALL***"で行
きましょう。
//結果の変更点がわかりましたか?

アイコン見れば解る通り、フォンナンバー(電話番号)まで取得されてる…。
後…現在地(住所)にメールアドレスに…(恐)。
ついでに、Personを指定すれば人間アイコンとその名前が取得出来たら出ます。
/*ユーザー*/
後は、Rename(名前を変えて自分が解りやすいようにする機能)などなど…。



