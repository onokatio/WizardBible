x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x

--- 第○章: OllyWindowPos  ---

著者：金床

x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x


■0x01.) はじめに

　WizardBibleもついに40号を迎えたということで、編集部の方々にはお祝い申し
上げる。最近は外国人の読者も着実に増えているらしく、外国人が日本語を学ぶ
動機のトップ3は

1位　ビジネスで使う
2位　アニメ・漫画を読みたい
3位　ウィザードバイブルを読みたい

　となっているというｳﾜｻである。

　さてめでたい40号だが、いかんせん育児と仕事の両立で苦しんでいるのでﾈﾀ不
足である。というか2月と3月働き過ぎてｶﾛｰｼである。ﾊﾗｷﾘ・ｻﾑﾗｲ・ﾌｼﾞﾔﾏ・ｹﾞｲｼｬ
・ｽｼ・ｶﾛｰｼ。
　えーと、なんの話だっけ。


■0x02.) つぎに

　そうそう、ﾈﾀ不足という話であった。
　WizardBibleで日本語を勉強している外国人のためにﾗﾃﾝ系紳士の金床が親切丁
寧に説明するが、「ﾈﾀ」とはｽｼの上部に位置する魚介類を指す。そしてごはん（
ライス）の部分はｼｬﾘとよぶ。「ﾈﾀ」と「ｼｬﾘ」が渾然一体となってかもしだす優
雅な味こそがｽｼの真骨頂である。そして「ﾈﾀ不足」というのは「お客さんがいっ
ぱい来たので今日はもう何も出せません」という店側からのﾒｯｾｰｼﾞだ。

　「ﾈﾀ」は「ｻｼｰﾐ」に似ているが、異なる。これは素人が間違えやすい点なので
注意したい。「ｻｼｰﾐ」は最初からそれ単体で食べられることを目的に加工された
食品であり、料理法も異なるのである。「ｽｼ」が出てきたときに「ｻｼｰﾐから先に
ﾀﾍﾞﾏｽ」などといってﾈﾀだけ食べてはいけないので注意したい。
　えーと、なんの話だっけ。


■0x03.) つづいて

　ということでﾈﾀ不足なので、こんなときのためにﾊｰﾄﾞﾃﾞｨｽｸの奥にしまっておい
たOllyDbg用のﾌﾟﾗｸﾞｲﾝの「OllyWindowPos」を取り出すことにした。かつて筆者が
mixiを使っていたころに適当にmixi内で公開したものだ。また最近では筆者のｳｪﾌﾞ
ｻｲﾄに置いてあるので、知っている人もいるかと思う。

　このﾌﾟﾗｸﾞｲﾝはﾕｰｻﾞｲﾝﾀｰﾌｪｰｽを改善する目的で作ったもので、OllyDbgでたくさ
ん登場するｳｨﾝﾄﾞｳの大きさや位置を記録・再生するものだ。ﾒｲﾝｳｨﾝﾄﾞｳの位置もコ
ントロールでき、特にﾃﾞｭｱﾙﾃﾞｨｽﾌﾟﾚｲﾕｰｻﾞにｵｽｽﾒである。なぜならばOllyDbgは起
動したときに片方のﾃﾞｨｽﾌﾟﾚｲにおさまるようｻｲｽﾞを自ら調整してしまうからだ。
ﾃﾞｭｱﾙﾃﾞｨｽﾌﾟﾚｲ全体に広がるように各ｳｨﾝﾄﾞｳを配置しても、再起動すると元に戻っ
てしまうのである。これは筆者にとって非常にｽﾄﾚｽであり、OllyWindowPosという
ﾌﾟﾗｸﾞｲﾝを作ることになったのだ。

　ﾀﾞｳﾝﾛｰﾄﾞは以下から。
　http://www.jumperz.net/tools/OllyWindowPos.tar.gz


■0x04.） ﾌﾟﾗｸﾞｲﾝの作成方法

　OllyDbgのﾌﾟﾗｸﾞｲﾝはDLLとして作成し、exeと同じﾃﾞｨﾚｸﾄﾘに置くだけで使えるよ
うになる。詳しくはｸﾗｯｷﾝｸﾞﾊﾞｲﾌﾞﾙのDokoDonさんの記事を読んでいただきたい。
筆者はこのDokoDonさんの記事のおかげですんなりﾌﾟﾗｸﾞｲﾝの作成に入ることがで
きた。


■0x05.） BCB

　OllyWindowPosはBorland C++ Builder5で作成されている。ﾌﾟﾛｼﾞｪｸﾄﾌｧｲﾙなども
すべてまとめて置いてあるので、今時BCBを使っているﾏﾆｱがいればそのままﾋﾞﾙﾄﾞ
することができる。


■0x06.） 使い方

　OllyWindowPosをｲﾝｽﾄｰﾙ（DLLをﾃﾞｨﾚｸﾄﾘにｺﾋﾟｰ）してからOllyDbgを起動すると、
「plugins」ﾒﾆｭｰに「Window Position」ﾒﾆｭｰが追加される。いくつかのｳｨﾝﾄﾞｳを
好きな位置・好きな大きさにしてから「Save as 1」を選ぶとそのときのポジショ
ンが「1」として記録される。ｳｨﾝﾄﾞｳの位置をばらばらに変えた後から「Restore
 1」を選ぶと先ほど保存したときの状態に戻すことができる。ﾃﾞｰﾀは1から5まで
用意されているので、好きなﾎﾟｼﾞｼｮﾝを5つまで保存しておくことができる。


■0x07.） Sauceｺｰﾄﾞ

　筆者はJava使いなのだがこのﾌﾟﾗｸﾞｲﾝはC++で作成されている。WindowsのAPIを
直に呼び出すということもあまりやったことがなかったので実に勉強になった。
見てもらえばわかるように「動けばいいや」的なやっつけ仕事になってしまって
いるが、これは小さなプログラムということでご勘弁いただきたい。Java使いら
しく横着にvectorやstring、mapなどを使いまくってみた。

　各ｳｨﾝﾄﾞｳを表示する処理ではﾒﾆｭｰが選択されたように（OllyDbgﾌﾟﾛｾｽに）見せ
るためにPostMessageを使ってみた。この再引数に当たる数字（2109や2117など）
はﾘｿｰｽﾊカーというﾂｰﾙでﾊｶｰした記憶がある。
　また各ﾎﾟｼﾞｼｮﾝはiniﾌｧｲﾙに保存されており、この情報を取り扱う際にはOllyDbg
がﾌﾟﾗｸﾞｲﾝ向けに提供しているAPIを利用している。


■0x08.） おわりに

　今回はﾈﾀとｻｼｰﾐの違いについて詳しく解説した。次回は「日本人の宗教とｶﾛｰｼ」
についてお話したいと思う。



