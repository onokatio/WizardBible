x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x

--- 第○章: 錠前の鍵違い数について ---

著者：IPUSIRON

x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x


■0x01.) はじめに

　錠前のカタログを確認するとピッキングや破錠に対する耐性や値段だけでなく、たびたび鍵違い数が記載されている。鍵違い数の値が大きいことを売りにしているような記述になっているが、そもそも鍵違い数とは何かということが明記されていないことが多い。そこで本稿では鍵違い数の意味や各種錠前の鍵違い数の違いについて紹介する。

　まず鍵違い数の意味であるが、これは直観的に意味はわかりやすい。鍵違い数とは鍵のパターン数のことである。鍵のパターンは鍵山の形や鍵そのものの形によって増減する。
　例えば、ある錠前の鍵違い数が1万であれば、その錠前を開錠するための鍵として1万個のパターンが存在するということである。

　ところで、錠前の不正解錠を防ぐためのアプローチとしては、「不正解錠という行為を困難にするアプローチ」と「不正解錠するために試行する回数を多くするというアプローチ」に大別できる。
　鍵違い数が大きいことは、後者のアプローチに関係する。つまり、鍵違い数が大きければ、不正解錠という行為によって解錠に成功させるまでの時間を長くすることができるわけである。
　なお、前者のアプローチは、キーウェイの形状やアンチピッキングピンの導入、錠前の構造に対する工夫などによって実現される。

　それでは代表的な各種の錠前の鍵違い数の数え方について紹介する。

■0x02.) ウォード錠の鍵違い数

　ウォードとは鍵に対する障害物のことであり、この障害物をよけて通る鍵だけがウォード錠を開けることができる。

　ウォードの取り付け位置は、鍵を入れる孔や錠前の内部に設けられる。
　鍵を入れる孔のウォードは鍵違い数を増やすだけでなく、ピッキングの道具などを挿入することを拒んだり、ピッキング行為をやりにくくするためにも有効である。そのため、現在の錠前でもキーウェイ（鍵を入れる孔の溝）を複雑にすることがある。

　ウォード錠かどうかを識別するには鍵の形を見るのが一番簡単である。
　まず棒鍵かどうかで識別する。棒鍵であればウォード錠かレバータンブラー錠であることが多い。ただし、棒鍵ではないウォード錠の仕組みを採用した南京錠も存在する。
　次に、鍵山に注目する。鍵山の凹部が棒に対して垂直に付いている鍵（ベッグ・ウォード型、ホイル・ウォード型、ニブ・ウォード型）や複雑な切り欠けが入っている鍵（ブリッジ・ウォード型）である。

    -----------
    |         |
    ---|   |---
       |   |
    ---|   |---
----|         |
              |
---------------

    -----------
    |         |
    ---|      |
    ---|      |
    |         |
    ---|      |
    ---|      |
----|         |
              |
---------------

　ウォード錠の鍵違いは、基本的には次に示す事項から決定される。

①ウォードの位置

　鍵を入れる孔に設けられたウォードであれば数種類しか鍵違いがない。
　一方、錠前の内部に設けられたウォードであれば精巧に作られたものであれば百数種類の鍵違いが得られる。


■0x03.) レバータンブラー錠の鍵違い数

　レバータンブラー錠は数枚の（レバー）タンブラーと呼ばれる板によりツク（角棒）を固定することで施錠する錠前である。
　素朴な構造を持つレバータンブラー錠の場合はタンブラーにはH状の切り欠き（ゲートと呼ぶ）が掘り込まれている。このH状の真ん中の「－」の部分がすべて揃うことにより、ツクを左側の切り欠きの箇所から右側の切り欠きの箇所に移動することができ、結果としてツクと一体化している閂が外れる。

　レバータンブラー錠かどうかを識別するには鍵の形を見るのが一番簡単である。ウォード錠と異なり、凹部が棒と水平に付いている。

    --- --- ---
    | | | | | |
    | --- --- |
    |         |
----|         |
              |
---------------

　レバータンブラー錠の鍵違いは、基本的には次に示す事項から決定される。

①タンブラーの種類
②タンブラーの枚数

　タンブラーの種類は、ゲートの位置の高さによって区分され、このゲートの位置は鍵の刻みの深さに対応する。
　鍵穴がドアの向こう側に貫通しているようなタイプの場合は、外側・内側の両方から鍵をかけることができる。ドアの中にタンブラーと錠箱（閂と連動している錠内部の箇所）を格納するスペースの都合上、レバータンブラー錠は3～4枚ほどしか入っていない。さらに、そのうち1枚は鍵違いには役立っていないことが多い。
　鍵を見て鍵山（レバータンブラー錠ではレバーステップという）の数が5個あるように見えても、外側・内側の両方から鍵をかけることができる錠前であれば、刻みは左右対称になっており、実質的に3個の鍵山だけが鍵違いに関係していることになる。

　タンブラーの種類をn、タンブラーの枚数をr、取り除くパターンをαとすると、鍵違い数は次のようにして計算できる（金庫向けやマスターキーシステムは含まない）。

鍵違い数＝n^r-α

　例えば、一般のレバータンブラー錠の場合は、タンブラーの枚数は3～4枚あり、タンブラーの種類は5種類存在する。ただし、鍵違いに役立つタンブラーの枚数はそのうちの2～3枚になる。
　ここでは鍵違いに役立つタンブラーの枚数が2枚であると仮定すると、鍵違いのパターンは5^2＝25通りになる。しかし、まったく刻みのないパターンはブランクキーで開いてしまうので除く。さらに、最も深い刻みと刻みがないパターンが交互になってしまうようなノコギリ状の場合は歯が折れる可能性を考慮して除かれることが多い。つまり、全体のパターンから2パターンを取り除く。つまり、先ほどの例で言えば、鍵違い数は23通り（＝25-2）となる。
　仮に鍵違いに役立つタンブラーの枚数が3枚であると仮定しても、123通り（＝5^3-2）程度である。

　これでは少なすぎるため、ウォード錠の原理を組み合わせて、2～4倍に増やす場合も多い。


■0x04.) ピンシリンダー錠の鍵違い数

　ピンタンブラー錠はレバータンブラー錠のように扉の両側から使用しないため、鍵山を前後対称にすることを考える必要がないため、ピンの本数全部がすべて鍵違いに役に立つ。

　ピンシリンダー錠の鍵違いは、基本的には次に示す事項から決定される。

①ピンの数
②ピンの長さの種類
③キーウェイの種類

　ピンの数が多ければ、鍵山の数もそれに応じて多くなる。

　また、ピンシリンダー錠の構造上、「下ピンの長さ＋鍵山の高さ＝内筒の直径」になる。内筒の直径はピンシリンダー錠の種類が決定すれば固定であるため、鍵山の高さが長い場合は下ピンは短く、鍵山の高さが短い場合は下ピンが長いということになる。
　鍵山の高さがすべて0のときはブランキーで開いてしまうため、このパターンは通常は除く。

　さらに同一のタイプの内部構造を持つピンシリンダー錠であってもキーウェイの種類を複数持たせることによって、鍵違いを増やすことができる。
　このキーウェイの種類が多いと鍵違いを増やすことができるが、合い鍵屋にとってはその分用意しておくブランクキーの数が増えるという現状を生み出している（鍵山の高さに関しては合鍵を作るマシンでコピーできるが、キーウェイはコピーできないため）。

　ピンの長さの種類をn、ピンの数をr、キーウェイの種類をmとすると、鍵違い数は次のようにして計算できる（マスターキーシステムは含まない）。

鍵違い数＝m(n^r-1)

　八万ロックはピンの配置が円状、ディンプル錠はピンの配置が多列になっているというだけであり、基本的に上記の公式が当てはまる。

　上下にドライバーピンを持つダブルピンタンブラー錠の場合は、構造的に外筒が大きくなるが、ピンの数を倍程度に増やすことができるため、鍵違い数を増やすためには有効である。
　また、八万ロックのピンは8～10本、（玄関などに使われる）ディンプル錠のピンは15～20本程度と多くのピンを持たせることができるため、鍵違い数を増やしやすい。最もこれらの錠前は単純に鍵違い数を増やすということよりも、不正に解錠されることを防ぐための工夫を施し、結果的に鍵違い数が増えたともいえるだろう。
　例えば、FBロックの場合は20本、KABA STARの場合は21本（後継機種の場合は26本）、V18の場合は18本、SHOWA製のXキーシリンダーの場合は8本以上のピンを持つ。Mul-T-Lockの場合ピンの中に細長いピンが入っている、即ち1箇所に2ピン存在する。


■0x05.) ディスクタンブラー錠の鍵違い数

　玄関などに使用されるディスクタンブラー錠の鍵は通常上下の鍵山が有効に働く。
　タンブラーの段差数が5段階であり、両面であることを考慮すると、タンブラーの段差数は9段階(上下をプラス・マイナスで表現すると、-4,-3,-2,-1,-0,1,2,3,4)といえる。

　段差数をn、ディスクの数をr、キーウェイの種類をmとすると、両面ディスクタンブラー錠の鍵違い数は次のようにして計算できる。

鍵違い数＝m((2n-1)^r-1)

　例えば、MIWAの両面ディスクタンブラー錠の場合は、タンブラーの段差は4段階、ディスク（が格納される空間）の数は10枚、キーウェイは1種類である。よって、上記の公式に当てはめれば、鍵違い数は282,475,249通り（＝(2×4-1)^10＝7^10）である。
　ただし、販売されたままの状態の場合は、ディスクが格納される空間の2つは空いた状態になっているため、実質的にはディスクの数は8枚である。よって、鍵違い数は5,764,801通り（＝(2×4-1)^8＝7^8）である。

　もう1つ例を挙げる。例えば、MIWAのU9の場合は、タンブラーの段差は5段階、ディスクの数は9枚、キーウェイは1種類である。よって、鍵違い数は387,420,489通り（＝(2×5-1)^9）である。


■0x06.) EC錠の鍵違い数

　EC錠とは鍵内に磁石が埋め込まれているタイプの錠前である。EC錠に一言でいっても色々あるため、ここでは日本で普及しているMIWAのEC錠について説明する。

　MIWAのEC錠の場合は、鍵の磁石の位置やN/Sの方向だけではなく、1列のディンプルが用意されている。
　まず磁石についてだが、磁石の位置によって2つのタイプに分けられる（XEC/RXEC）。また、磁石の方向としてはN極とS極の2パターンあり、磁石の取り付け位置は6箇所ある。よって、磁石だけの観点からの鍵違い数は64通り（＝2×2^6）である。
　ただし、6箇所すべてに磁石が使われるとは限らず、一部にダミーが使用されることもある。この場合は鍵違い数がその分減ることを意味する。
　次にディンプルについてだが、ディンプルの深さの種類には実質5段階あるのだが、深さ0,1は使用されず、深さ2,3,4だけしか使用されない。またディンプルの個数は4箇所である。よって、ディンプルだけの観点からの鍵違い数は81通り（＝3^4）である。
　ゆえに、キーウェイは1種類であるため、鍵違い数は5,184通り（64×81）である。

　ダミー数をα、ディスクの数をr、キーウェイの種類をmとすると、MIWAのEC錠の鍵違い数は次のようにして計算できる。

鍵違い数＝(2×2^(6-α))×(3^4)＝81×2^(7-α)


■0x08.) まとめ

　最後に現在玄関に使われている錠前の鍵違い数について、表にまとめた。

|錠前の種類|タイプ|鍵違い数|リバーシブル|その他特徴|
|U9|ディスクタンブラー錠|約1億5100万通り|×|安価。ロッキングバーを採用。|
|U9 HM|ディスクタンブラー錠|150,994,944通り|×|ロッキングバーを採用。|
|KABA Star|ディンプル錠|約172億通り|○||
|PRシリンダー|ディスクタンブラー錠|約1000億通り|○|2WAY構造のタンブラー、アンチピッキングタンブラーを持つ。ロッキングバーを採用。|
|JNシリンダー|ディンプル錠|約172億通り|○||
|FBロック|ディンプル錠|最大1300億通り|○|鍵の先端にフローティングボールを持つ。|
|V18|ディンプル錠|約120億通り|○|アンチピッキングピンを持つ。|
|GVシリンダー|ディンプル錠|1000兆2800億通り|×|V18の上位モデル。|
|Mul-T-Lock|ディンプル錠|約3億6千万通り|○||
|WEST リプレイスシリンダー(916,917)|ディンプル錠|約2,935億通り|○|アンチピッキングピンを持つ。クリックボールがあるためキーの抜き差しがスムーズ。|
|ロイヤルガーディアン|ディンプル錠|約14億通り|○|バンピング、カム送り解錠を防ぐ。|


　本当は和錠や組み合わせ錠のような特殊な錠前の鍵違い数についても紹介したかったが、まだ自分の中で整理できていなかった部分もあるので、今回は代表的な錠前の鍵違い数についてのみ解説した。

