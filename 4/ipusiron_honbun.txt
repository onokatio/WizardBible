x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x

 --- 第９章：アタッカーのためのアカウント入門 ---

 著者：IPUSIRON

x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x
x0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0xx0xXx0x


■0x01.) はじめに

　今回は、アカウントの基礎的な概念から学び、経験で得られる各アカウントの
価値を解説したいと思います。

　読むに当たり注意してもらいたいことがあります。それは、アカウントという
言葉の使い分けです。ここではアカウントとは、アカウントIDとパスワードのセ
ットになっているものを指すことにします。


■0x02.) アカウントの分類

　簡単にアカウントと言えども、様々なアカウントがあります。
　思いつくものをざっと列挙すると次のようになります。他にもありますが、メ
ジャーなものはこのぐらいだと思います。分類といっても、共通部分が空集合で
はなく、アカウントによっては重複しているものもあります。例えば、Joeアカウ
ントかつゲストアカウント、FTPアカウントかつシェルアカウントなどといった具
合です。

・インターネット接続アカウント（ダイヤルアップアカウント、PPPoEアカウント）
・メールアカウント（POPアカウント、Webメールアカウント）
・FTPアカウント
・シェルアカウント
・ゲストアカウント
・ユーザーアカウント
・管理者アカウント（root,Administratorユーザー）
・バックドアアカウント
・著名アカウント
・Joeアカウント
・ベンダアカウント（デフォルトアカウント）
・サービスアカウント

●インターネット接続アカウント
　インターネットに接続するために使用するアカウントです。ダイヤルアップア
カウント、PPPoEアカウントなどがあります。
　昔はインターネットに接続するための費用が高かったので、それなりの需要も
ありましたが、今は昔ほど需要はありません。とはいえ、他人のインターネット
接続アカウントを使用することができれば、少なからず匿名化はできるので、そ
れなりの価値はあります。また、プロバイダによりますが、POPアカウントもセッ
トになっていることも多々あります。

●メールアカウント
　メール用のアカウントです。通常、POPアカウント、Webメールアカウントに大
別されます。前者はメーラーでPOPサーバーにアクセスしてメールを受信するタイ
プ、後者はブラウザでHTTP経由でログインして送受信の操作を行うタイプです。
これらPOPアカウントとWebメールアカウントについて、アタッカーからの立場で
の価値は後述しています。
　メールアカウントを乗っ取ることができれば、乗っ取った相手のメールを盗み
見ることができます。ちなみに、管理者アカウントさえあれば、そのサーバーを
使っている全員のメールを盗み見ることも可能です。

●FTPアカウント
　FTPサービスを利用できる（ユーザー）アカウントです。ファイルをアップロー
ドしたり、ダウンロードしたりできます。Webサイト公開用にレンタルサーバーを
借りると、FTPアカウントがもらえます。

●シェルアカウント
　UNIXのシェルを操作できる権限を持つアカウントです。
　大学のUNIXサーバー、企業のUNIXサーバー、個人宅のUNIXサーバーを突破する
と、得ることができます。よって、ターゲットがUNIXサーバーで、FTPアカウント
あるいはPOPアカウントを奪取したと同時に、シェルアカウントも奪取できること
もあります。
　シェルアカウントがあれば、そのサーバーを踏み台にして他のサーバーをアタ
ックすることもできます。

●ゲストアカウント
　ゲストアカウントは、通常使用されず限られた短い期間だけシステムへのアク
セスを許された人物のために使用されるアカウントです。一時的に使われるため
に作成されるアカウントなので、アカウントIDがguest、パスワードがguestとい
った簡単なパスワードに設定されることが多々あります。さらに、ゲストアカウ
ントが削除されず放置されたままになっているサーバーも存在します。大抵その
ようなサーバーは他の弱点も抱えていることが多いので、アタックの足掛かりと
して利用しやすいです。

●ユーザーアカウント
　ユーザー権限のアカウントのことです。例えば、FTPアカウント、メールアカウ
ント、MMORPGのアカウントも一種のユーザーアカウントです。

　アタッカーにとって、ユーザーアカウントを奪取したら、次にユーザーアカウ
ントの上の管理者アカウントを乗っ取ることが目標になります。
　サービスを受けているユーザーや内部のユーザーは、すでにユーザーアカウン
トを持っているので、アタックしやすいです。海外のレンタルサーバーによって
は、月数十ドルでシェルやPOPのユーザーアカウントを提供しているところもある
ので、そういうところを悪用するという手口もあります。

●管理者アカウント
　管理者権限のアカウントのことです。UNIXの管理者権限のユーザーはroot、Win
dows（NT/2000/XP）の管理者権限のユーザーはAdministratorです。
　ターゲットの管理者権限のアカウントさえ奪うことができれば、そのマシンは
乗っ取れたことになります。ただし、HTTP経由でパスワードファイルを閲覧し、
それのパスワードが判明したとしても、tcp wrapperなどでアクセス制限がかけら
れていれば、アクセスできないので、そのマシンを奪ったとは言えません。
　実際に、PHP Nukeの脆弱性を突いて、パスワードファイルを入手し、John the 
Ripperでrootのパスワードを解析して、いざアクセスしようとしたら外部からの
アクセスが制限されていたということがあります。

●バックドアアカウント
　アタッカーが設置したトロイの木馬やバックドアにアクセスするためのアカウ
ントです。
　他人が設置したバックドアアカウントを拝借することができれば、罪をなすり
つけることができます。

●Joeアカウント
　アカウントIDとパスワードが全く同じアカウントのことです。例えば、アカウ
ントIDが「ipusiron」でパスワードも「ipusiron」と設定されたアカウントがそ
うです。
　Joeアカウントは、パスワードクラッカーを使いことなく、手動で簡単に突破さ
れてしまいます。

●ベンダアカウント
　ベンダが用意するインストールプログラムは、幾つかのデフォルトのアカウン
トをパスワードファイルに設定する場合があります。これはデフォルトアカウン
トとも呼ばれます。特にルーターやファイアウォール製品といったハードウェア、
何らかのソフトウェアにデフォルトで設定されています。運用時にはデフォルト
のパスワードを変更することが取扱説明書などに記載されていますが、一部の人
はそれを無視あるいは知らないでそのまま運営してしまうことがあります。ルー
ターなどのデフォルトアカウントはインターネット上で公開されており、そのま
まだと簡単なオンラインパスワードアタックで突破されてしまいます。

●サービスアカウント
　サービスアカウントとは、特別なプログラムをシェルとして登録したアカウン
トです。これらのアカウントには通常パスワードが無く、例えば誰がログインし
ているかを調べるwhoやプリンタキューの状態を表示するlpqなどで使われます。


■0x03.) WebメールのアカウントとPOPメールのアカウントの比較

　メールアカウントを奪取すると言っても、大きく分けてWebメールのアカウント
とPOPメールのアカウントがあります。利用者にとっては同じメールという役目を
果たしますが、アタッカーからの観点から見ると性質が大きく異なります。

　Webメールとは、サービス提供サイトにWebブラウザでアクセスし、そこで認証
してオンライン上でメールの作成・送信・受信を行います。一方、POPメールとは、
ユーザーがあらかじめOEやBecky!などのメーラーを用意して、ユーザー自身が各
設定をしてPCに受信してからメールを読んだりします。

　この２つのタイプのメールについて、アタッカーから見た特徴を次に列挙した
いと思います。

●Webメールの特徴

・放置されているWebメールアカウントも多い。多くの場合、フリーのWebメール
になるわけなので、正規ユーザーが不用と思った場合、使用されないまま放置さ
れる可能性が多いです。よって、POPメールのアカウントより、短命といえます
（メールを覗くという意味であり、利用寿命とは異なります）。ただし、完全に
放置されたメールアカウントであれば、勝手に自分用として使えるというメリッ
トもあります。
・POPメールと異なり、受信メールを読める可能性が高いです。
・利用ユーザーが意識的に削除しない限り、送信メールも覗けます。これはPOPメ
ールの方では真似できない、大きなメリットです。
・メールを閲覧すると開封アイコンになってしまいます。よって、新規受信メー
ルを勝手に開いてしまうとターゲットにばれる可能性があります。一回正規ユー
ザーが閲覧した後、即ち開封アイコンになったメールは覗いてもばれません。
・匿名性を気にするならば、HTTP Proxyでアクセスすればよいので、踏み台サー
バーも所有しなくてもよい。
・ネットカフェにおいて、Sniffingをすることで、POPメールよりも比較的入手し
やすいです。

●POPメールの特徴

・基本的にメール受信時にメールサーバーからメールを削除するように設定する
人が多いので、アタッカーはメールサーバーからメールを削除しないに設定して
常に１分おきぐらいの頻度で受信する必要があります。
・そのメールアカウントを利用しているユーザーがメーラーにおいて、受信した
メールを削除しないという設定、つまりメールサーバーから削除しないような設
定の場合、アタッカーにとって美味しいことになります。
　なぜならば、アタッカーは常にメールアカウントを見張り自動受信しなくても
よいからです。さらに、メールサーバーにメールが残っているということは、ア
タッカーがメールアカウントを乗っ取る以前のメールに関しても読むことができ
るということです。
・生IPで受信するのが怖い場合、踏み台サーバー経由、Socks Proxyを利用するこ
とになってしまいます。
・POPメールアカウントのIDとパスワードが、FTPアカウント、シェルアカウント
と同一の可能性も高いので、副産物が大きいです。
・売買IRCにおいて、物々交換するとき、Webメールより高いレート扱いになりま
す。
・メールサーバーのAdministrator、rootアカウントさえ奪ってしまえば、多数の
POPアカウントを奪えます。


■0x04.) ある売買マーケットにおけるアカウントのレート

　あくまでこのレートは私が知っている売買IRC（交換が主）のレートなので、他
の相場とは異なるかもしれません。よって、参考程度に見ておいてください。

・ゲストアカウント10＝ユーザーアカウント1（シェルアカウント）
・ユーザーアカウント10（シェルアカウント）＝管理者アカウント1
・クレジットカード番号20＝管理者アカウント1
・ユーザーアカウント20（メールアカウント）＝ユーザーアカウント1（シェルアカウント）

　メールアカウントはメールアドレスだけをさすのではなく、アカウントIPとパ
スワードも含んでいることに注意してください。

　交換あなたがルート権限を奪うようなスキルがなくても、何とかメールアカウ
ントを200個入手できば、ルートアカウント１つと交換できるわけです。

　このメールアカウントはWebメールのでも良いし、POPメールでも何でも良いわ
けです。よって、別にハッキングして手に入れたものでなくても、自分が取得し
た200個でもよいわけです。ただし、メアド取得ツールを使っても、同じホストの
メールアドレスなので、そんなもの200個あっても嫌がられるので、うまく分散す
れば水増しして誤魔化すしかないでしょう。もちろん、自分が取得した場合、そ
のメアドを悪用されて何か問題が起きたとき、登録した貴方が先に疑われる可能
性が高いです。

　他にもこの売買IRCでは脆弱ホストのリストやスキャン結果のリストなどもやり
取りされます。


■0x06.) メールアカウントが無事かどうかを調べる

　この項では、自分のメールアカウントが無事かどうかをチェックする簡単な方
法を紹介します。簡単だが有効なので多用しています（ここで書いて多くの人に
知られたら、意味がなくなってしまうのですが…）。

　通常、アタッカーvsサーバー管理者という構図で攻防が繰り広げられますが、
時々アタッカーvsアタッカーという構図も起こり得ます。例えば、個人的に恨み
を買ったり、コミュニティ同士の派閥争いなどがそうです。このような時は特に
自分たちのやり取りしている情報が無事かどうか不安でたまりません。こちらの
情報が相手に筒抜けだと行動が先読みされてしまい、必ず後手になってしまい不
利だからです。そこで使う手がこれです。

１：あらかじめ信頼できる人を直接または電話でコンタクトを取り、これから述
べることを合意させておく。電話は少なからず盗聴の可能性があるのでやはり、
直接がよい。

２：何らかの合図が含まれたメールは無視してもらうように相手に頼んでおきま
す。例えば、メールの件名（サブジェクト）の末に「。」がついていれば無視と
いうようにしておきます。

３：通常通りメールをやり取りしあいます。そのメールはステップ１で頼み込ん
だ人以外とも、やりとりしておいて、普通にメールアカウントを使用します。

４：ある日、メールの件名に合図を含め、本文では脆弱なサーバーを手に入れた
風な文面を書きます。そこにはサーバーのIPアドレス、SSHやFTPのアカウント情
報を記述しておきます。

５：アタッカーがこのメールを不正に奪える状態にあるならば、これを読んで、
さっそく行動に移すと思われます。敵対するアタッカーは自分に有利な状態を作
るために、そのサーバーに侵入して、裏をかけるように何らかの仕掛けを仕込も
うとします。

６：しかし、サーバーに侵入された時点でこちら側が優勢です。なぜならば、敵
対するアタッカーが侵入したサーバーは実はこちら側が用意したハニーポットだ
からです。つまり、ハニーポットのログに侵入の痕跡があったならば、私たちの
やり取りしたメールが誰かに読まれていたと即断できます。なぜならば、それ専
用に構築したわけですから。逆に何の痕跡がなければ、メールは不正に読まれて
いないと判断でき、しばらくは安心して使用することができるでしょう。

　こういうことを1週間に1回ぐらいやっておけば、メールの不正の被害を最小限
に食い止めることができると思います。


■0x07.) オークションにおけるアカウントの実売価格

　裏インターネット事件簿の「もっとも危険な裏商品“架空ＩＤ”とは？」
（http://www.jikenbo.net/jikenbo/docs/20030802-001.shtml）に、次のような
記述がありました。

-----  最後のところの引用
２年ほど前にオークション詐欺を行っていたＧ氏は、この架空ＩＤについて「当
時は１ＩＤあたり１−２万円程度で手に入ったよ。一度にいくつも買って使いま
わすんだよね。おれは不正モノの販売詐欺だったけど、けっこうもうかったよ」
とうそぶく。そのうえで、架空モノを使うことの“危険性”についても語ってく
れた。「もしものことを考えて、５件くらい詐欺に使ったら、すぐ他人に転売す
るんだ。架空モノは悪用後に転売されることも多いから、買ったＩＤをそのまま
使うと前ユーザーの余罪をカブったり、ＩＤを乗っ取られたりすることがあるん
だよ」。
-----

　架空IDが１〜２万なんてぼったくりだと思います。売買IRCの方では交換が主で
あまり現金（リアルマネー）でやり取りされませんが、それでも現金計算すると
架空ID、即ちWebの何らかのアカウントは日本円で数百円程度です。もちろん、数
百円程度でやり取りされないから、数十個まとめて１万円単位ぐらいでやりとり
されます。
　よって、あなたが架空IDやアカウントを購入したいと思っても、Yahooオークシ
ョンで買うより、コネで誰かに頼み購入した方が安上がりだと思います。


■0x08.) MMORPGのユーザーアカウント

　管理者アカウントでさえ１万円にはなりませんが（依頼主がいたり、大企業の
アカウントなら別）、値段が高額なアカウントもあります。それはMMORPGのアカ
ウントです。私はリネージュしか本格的にやったことがないので（軽くならば色
々やったことがある）、他のゲームが分かりませんが、リネージュならば、高レ
ベルキャラがあるアカウント１つで数万円になります（今は全体的に相場が下が
っていますが）。おそらく他のMMORPGも同様でしょう。リネージュの場合、１つ
のアカウントで３キャラまで育成できます。リネージュユーザーの中には１つだ
けではなく、２，３つのアカウントを所有している人もいます。もちろん、１ア
カウントで課金されるので、２アカウント持っていれば２倍の課金がかかります。

　さらに、アタッカーにとってお得なのは、アカウントそのものの価値よりも、
そのアカウントのキャラが所有する装備品、アイテム、そしてお金などです。高
レベルキャラが持つ装備品やお金などを総合すると、数Mアデナ、つまりリアルマ
ネーで数万円になります。ものすごい強いキャラの人のものならば、数十万円に
もります。


■0x09.) デフォルトアカウントとコンボファイル

　ユーザーIDのリストとパスワードのリスト（つまり、普通の辞書ファイル）を
組み合わせて、パスワード解析を行うと膨大な数になってしまうことがあります。
そんな場合、ユーザーIDとパスワードの組合わせのリストを適度なサイズにした
ファイルを作ればよいでしょう。このようなファイルをコンボファイルと呼びま
す。

　コンボファイル（combo.txt）は、次のように、ユーザーIDとパスワードがTAB
またはスペースで区切られて、１行で１対応のリストになっています。 

-----
root test
root backup
ipusiron test
ipusiron backup
…（中略）…
-----

　このコンボファイルを使ったパスワードクラッキングは、ターゲットがデフォ
ルトアカウントであることを期待している時に多用されます。


■0x10.) 終わりに

　日記に書いたことを使いまわしてしまいましたが、読んでない人もいると思い、
Wizard Bibleのネタにしました。

　売買IRCを公開することはメンバーの人に許可を取ってありますが、存在する場
所や詳しい内容は漏らしてはいけないことになっているので、これらに関して一
切質問は受け付けません。

